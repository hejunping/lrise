
var ajax={timerID:0,url:null,onsuccess:null,onerror:null,id:0,createXHR:function(){},setup:function(serverURL,successHandler,errorHandler){ajax.url=serverURL;ajax.onsuccess=successHandler;ajax.onerror=errorHandler;if(typeof XMLHttpRequest!="undefined"){ajax.createXHR=function(){var xhr=new window.XMLHttpRequest();return xhr;};}else if(window.ActiveXObject){ajax.createXHR=function(){var aVers=["MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"];var xhr;for(var i=0;i<aVers.length;i++){try{xhr=new ActiveXObject(aVers[i]);break;}catch(e){}}return xhr;};}else{ajax.createXHR=function(){};}},appendRandomVal:function(url){return url+(url.indexOf('?')>0?"&":"?")+"r="+ajax.id++;},post:function(message,urlParams,onsuccess,onerror){var xhr=ajax.createXHR();xhr.open('POST',ajax.appendRandomVal(ajax.url)+(urlParams?("&"+urlParams):""),true);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(message);xhr.onreadystatechange=function(){if(xhr.readyState==4){var response=xhr.responseText;if(xhr.status&&xhr.status==200){if(onsuccess&&typeof onsuccess=='function')onsuccess(response);if(ajax.onsuccess&&typeof ajax.onsuccess=='function')ajax.onsuccess(response);}else{if(onerror&&typeof onerror=='function')onerror(xhr);if(ajax.onerror&&typeof ajax.onerror=='function')ajax.onerror(xhr);}}}}};var $=function(id){return document.getElementById(id);};function GetWindowWidth(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth;}function GetWindowHeight(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight;}function HtmlEncode(html){var div=document.createElement("div");var txt=document.createTextNode(html);div.appendChild(txt);return div.innerHTML;}function HtmlDecode(str){var div=document.createElement("div");div.innerHTML=str;return div.innerHTML;}function HandleException(e,method){if(e&&e.message){alert(e.message+" ["+method+"]");}}function confirmHTML(html){return confirm(HtmlDecode(html));}function alertHTML(html){return alert(HtmlDecode(html));}function UrlQueryString(param,defaultValue){var url=location.href;var paramString=url.substring(url.indexOf("?")+1,url.length).split("&");var paramObj={};for(var i=0;j=paramString[i];i++){paramObj[j.substring(0,j.indexOf("=")).toLowerCase()]=j.substring(j.indexOf("=")+1,j.length);}var returnValue=paramObj[param.toLowerCase()];if(typeof(returnValue)=="undefined"){return defaultValue;}else{return returnValue;}}function buttonProgress(btn,text){var submitProgress=0;function start(){btn.disabled=true;btn.value=text;var value="";for(var i=0;i<submitProgress;i++){value+=".";}btn.value=text+value;if(submitProgress>=3){submitProgress=1;}else{submitProgress++;}}setInterval(start,1000);}